\batchmode
\documentclass[14pt, openany]{book}
\pagestyle{plain}
\usepackage{setspace}
\usepackage{enumitem}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{extsizes}
\usepackage[english,russian]{babel}
\let\cdash=\rcdash
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{tempora}
\usepackage[nottoc,notlot,notlof,numbib]{tocbibind}
\usepackage{natbib}
\usepackage{indentfirst}
\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\normalfont\bfseries}{}{0pt}{\Huge}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{tlatex}
\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.98,0.98,0.98}

\lstdefinestyle{mystyle}{
    frame=single,
    aboveskip=5mm,
    belowskip=5mm,
    backgroundcolor=\color{backcolour},   
    language=scala,
    commentstyle=\color{codegreen},
    keywordstyle=\color{blue},
    numberstyle=\small\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=7pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
}

\lstset{style=mystyle}
  
\geometry{
    a4paper,
    left=20mm,
    top=20mm,
    right=20mm,
    bottom=20mm
}
\setlist[itemize]{noitemsep, topsep=0pt}
\setstretch{1.5}

\newcommand{\tlapl}{TLA\textsuperscript{+} }

\title{Применение формальных методов при спецификации бизнес-процессов}
\author{Морковкин Василий}
\date{2022}
\setlength{\parindent}{2em}

\setlength{\textwidth}{483.69pt}
\begin{document}
\makeatletter
\chardef\%=`\%
\fl{ {\p@mmalgorithm} crossroadPass}
\fl{ {\p@variables}}
\fl{ queue \.{=} [ d \.{\in} Dirs \.{\mapsto} {\langle} {\rangle} ] ,\,}
\fl{ wantTo \.{=} [ d \.{\in} Dirs \.{\mapsto} \{ \} ] ,\,}
\fl{ wantFrom \.{=} [ d \.{\in} Dirs \.{\mapsto} \{ \} ] ,\,}
\fl{ passing \.{=} [ d \.{\in} Dirs \.{\mapsto} \{ \} ] {\p@semicolon}}
\fl{ {\p@define}}
\fl{ CanMove ( car ,\, from ,\, to ) \.{\defeq}}
\fl{ \.{\LET}}
\fl{ Candidates \.{\defeq} Heads ( queue )}
\fl{ To ( t ) \.{\defeq} wantTo [ t ] \.{\cap} Candidates}
\fl{ From ( f ) \.{\defeq} wantFrom [ f ] \.{\cap} Candidates}
\fl{ Reversing ( d ) \.{\defeq} To ( d ) \.{\cap} From ( d )}
 \fl{ Conflicts ( f ,\, t ) \.{\defeq} ( ( To ( t ) \.{\cap} From ( RightTo [
 f ] ) ) \.{\,\backslash\,} Reversing ( t ) ) \.{\cup} passing [ t ]}
 \fl{ Reversal ( f ,\, t ) \.{\defeq} ( f \.{=} t ) \.{\implies} Cardinality (
 To ( t ) ) \.{=} 1%
\@y{%
  reversing car itself
}%
}
\fl{ \.{\IN}}
\fl{ car \.{\in} Candidates \.{\land}}
\fl{ Cardinality ( Conflicts ( from ,\, to ) ) \.{=} 0 \.{\land}}
\fl{ Reversal ( from ,\, to )}
\fl{ {\p@end} {\p@define} {\p@semicolon}}
\fl{}
\fl{ {\p@fair} {\p@process} car \.{\in} Cars}
\fl{ {\p@variables}}
 \fl{ from \.{\in} Dirs ,\, to \.{\in} Dirs ,\, state \.{=}\@w{Initial}
 {\p@semicolon}}
\fl{ {\p@begin}}
\fl{ Action\@s{.5}\textrm{:}\@s{3}}
\fl{ {\p@either}}
\fl{ {\p@await} state \.{=}\@w{Initial} {\p@semicolon}}
\fl{ state \.{:=}\@w{Waiting} {\p@semicolon}}
\fl{ queue [ from ] \.{:=} Append ( queue [ from ] ,\, self ) {\p@semicolon}}
\fl{ wantTo [ to ] \.{:=} wantTo [ to ] \.{\cup} \{ self \} {\p@semicolon}}
 \fl{ wantFrom [ from ] \.{:=} wantFrom [ from ] \.{\cup} \{ self \}
 {\p@semicolon}}
\fl{ {\p@or}}
\fl{ {\p@await} state \.{=}\@w{Waiting} {\p@semicolon}}
\fl{ {\p@await} CanMove ( self ,\, from ,\, to ) {\p@semicolon}}
\fl{ state \.{:=}\@w{Passing} {\p@semicolon}}
\fl{ passing [ to ] \.{:=} passing [ to ] \.{\cup} \{ self \} {\p@semicolon}}
\fl{ {\p@or}}
\fl{ {\p@await} state \.{=}\@w{Passing} {\p@semicolon}}
\fl{ state \.{:=}\@w{Initial} {\p@semicolon}}
\fl{ queue [ from ] \.{:=} Tail ( queue [ from ] ) {\p@semicolon}}
 \fl{ wantTo [ to ] \.{:=} wantTo [ to ] \.{\,\backslash\,} \{ self \}
 {\p@semicolon}}
 \fl{ wantFrom [ from ] \.{:=} wantFrom [ from ] \.{\,\backslash\,} \{ self \}
 {\p@semicolon}}
 \fl{ passing [ to ] \.{:=} passing [ to ] \.{\,\backslash\,} \{ self \}
 {\p@semicolon}}
\fl{ {\p@end} {\p@either} {\p@semicolon}}
\fl{ {\p@goto} Action {\p@semicolon}}
\fl{ {\p@end} {\p@process} {\p@semicolon}}
\fl{ {\p@end} {\p@algorithm} {\p@semicolon}}
\end{document}
